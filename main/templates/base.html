{% load static %}
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

	<title>Сайтик по доставке еды</title>

	<!-- Google font -->
	<!--<link href="https://fonts.googleapis.com/css?family=Hind:400,700" rel="stylesheet">-->

	<!--&lt;!&ndash; Bootstrap &ndash;&gt;-->
	<!--<link type="text/css" rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">-->
	<link type="text/css" rel="stylesheet" href="{% static 'css/bootstrap1.css' %}">
	<!-- Slick -->
	<link type="text/css" rel="stylesheet" href="{% static 'css/slick.css' %}">
	<link type="text/css" rel="stylesheet" href="{% static 'css/slick-theme.css' %}">

	<!-- nouislider -->
	<link type="text/css" rel="stylesheet" href="{% static 'css/nouislider.min.css' %}">

	<!-- Font Awesome Icon -->
	<link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}">s

	<!-- Custom stlylesheet -->
	<link type="text/css" rel="stylesheet" href="{% static 'css/style.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap1.css'%}">
	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		  <!--<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>-->
		  <!--<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>-->
		<![endif]-->

	<script src="http://swarm.simplecartjs.com/js/inject.js"></script>


</head>
<style>
	.myimg{

	max-height:160px;
	width:auto;
	}

</style>
<body>
		<div id="header">
			<div class="container">
				<div class="pull-left">
					<!-- Logo -->
					<div class="header-logo">
						<a class="logo" href="#">
							<a href="{% url 'home' %}">
							<img src="{% static 'img/logo.png' %}" class ="myimg" alt=""></a>
						</a>
					</div>

					<div class="header-search">
						   <form action="" method="get">
							   {% csrf_token %}
							<input name="search_box" class="input search-input" type="text" placeholder="Введите название">
							<!--<select class="input search-categories">-->

								<!--<option value="0">Поиск по ресторанам</option>-->
								<!--<option value="1">Поиск по блюдам</option>-->
							<!--</select>-->
							   <button class="search-btn"><i class="fa fa-search"></i></button>
						</form>
					</div>

				</div>

							<div class="pull-right">
					<ul class="header-btns">
						<!-- Account -->
						<li class="header-account dropdown default-dropdown">
							<div class="dropdown-toggle" role="button" data-toggle="dropdown" aria-expanded="true">
								<div class="header-btns-icon">
									<i class="fa fa-user-o"></i>
								</div>
								<strong class="text-uppercase">Мой профиль <i class="fa fa-caret-down"></i></strong>
							</div>

							<a href="#" class="text-uppercase">
	  {% if user.is_authenticated %}
	<span class="users">{{user.username}} |
	<a href="{% url 'newlogin' %}" >авторизован!</a></span>
	   {% else %}
	  <a href="{% url 'newregister' %} " class='users'>нет!</a>
	      {% endif %}
							</a>
							<ul class="custom-menu">
								<li><a href="{% url 'current_user' %}"><i class="fa fa-user-o"></i> Мой профиль</a></li>

								<li><a href="{% url 'newlogin' %}"><i class="fa fa-unlock-alt"></i> Войти</a></li>
								<li><a href="{% url 'newregister' %}"><i class="fa fa-user-plus"></i> Создать профиль</a></li>
							</ul>
						</li>
						<!-- /Account -->

						<!-- Cart -->
						<li class="header-cart dropdown default-dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" aria-expanded="true">
								<div class="header-btns-icon">
									<i class="fa fa-shopping-cart"></i>

								</div>
								<strong id ='checkout' class="text-uppercase">Корзина:</strong>
								<br>
								<span id="cart_price"></span>
							</a>
							<div class="custom-menu">
								<div id="shopping-cart">
									<div class="shopping-cart-list">
										   <div id="cart_content">
										<!--<div class="product product-widget">-->

											<!--<div class="product-body">-->
												<!--<h3 class="product-price">$32.50 <span class="qty">x3</span></h3>-->
												<!--<h2 class="product-name"><a href="#">Product Name Goes Here</a></h2>-->
											<!--</div>-->
											<!--<button class="cancel-btn"><i class="fa fa-trash"></i></button>-->
										<!--</div>-->

									</div>
									<div class="shopping-cart-btns">
										<a href="" id="create_order" class="btn btn-primary">Оформить заказ</a><br>

										<a href=""  class='btn btn-danger' id="clear_cart">Очистить корзину</a>
									</div>

								</div>
							</div>
							</div>
						</li>
						<!-- /Cart -->

						<!-- Mobile nav toggle-->
						<li class="nav-toggle">
							<button class="nav-toggle-btn main-btn icon-btn"><i class="fa fa-bars"></i></button>
						</li>
						<!-- / Mobile nav toggle -->
					</ul>
				</div>

				</div>
{% block body %}
{% endblock %}

	<!--<p>-->
	<!--Cart: <span class="simpleCart_total"></span> (<span id="simpleCart_quantity" class="simpleCart_quantity"></span> items)-->
	<!--<br />-->
	<!--<a href="javascript:;" class="simpleCart_empty">empty cart</a>-->
	<!--<br />-->
	<!--</p>-->



	<!-- FOOTER -->
	<footer id="footer" class="section section-grey">
		<!-- container -->
		<div class="container">
			<!-- row -->
			<div class="row">
				<!-- footer widget -->
				<div class="col-md-3 col-sm-6 col-xs-6">
					<div class="footer">
						<!-- footer logo -->
						<div class="footer-logo">
							<a class="logo" href="#">
		        <img src="{% static 'img/logo.png' %}" alt="">
		          </a>
						</div>
						<!-- /footer logo -->

						<h5>Звоните нам:</h5>
						<p>+7(702)6364540</p>

						<h5>Мы в соцсетях:</h5>
						<!-- footer social -->
						<ul class="footer-social">
							<li><a href="#"><i class="fa fa-facebook"></i></a></li>
							<li><a href="#"><i class="fa fa-twitter"></i></a></li>
							<li><a href="#"><i class="fa fa-instagram"></i></a></li>
							<li><a href="#"><i class="fa fa-google-plus"></i></a></li>
							<li><a href="#"><i class="fa fa-pinterest"></i></a></li>
						</ul>
						<!-- /footer social -->
					</div>
				</div>
				<!-- /footer widget -->

				<!-- footer widget -->

				<!-- /footer widget -->

				<div class="clearfix visible-sm visible-xs"></div>

				<!-- footer widget -->
				<div class="col-md-4 col-sm-6 col-xs-6">
					<div class="footer">
						<h3 class="footer-header">Информация клиетам</h3>
						<ul class="list-links">
							<li><a href="#">О нас</a></li>
							<li><a href="#">Контакты</a></li>
							<li><a href="#">FAQ</a></li>
						</ul>
					</div>
				</div>
				<!-- /footer widget -->

				<!-- footer subscribe -->
				<div class="col-md-4 col-sm-6 col-xs-6">
					<div class="footer">
						<h3 class="footer-header">Подписаться на обновления сайта </h3>
						<p>Присоединяйтесь к нам и первыми узнавайте
о самых вкусных местах:</p>
						<form>
							<div class="form-group">
								<input class="input" placeholder="Введи ваш e-mail">
							</div>
							<button class="primary-btn">Подписаться</button>
						</form>
					</div>
				</div>
				<!-- /footer subscribe -->
			</div>
			<!-- /row -->
			<hr>
			<!-- row -->
			<div class="row">
				<div class="col-md-8 col-md-offset-2 text-center">
					<!-- footer copyright -->

					<!-- /footer copyright -->
				</div>
			</div>
			<!-- /row -->
		</div>
		<!-- /container -->
	</footer>
	<!-- /FOOTER -->

	<!-- jQuery Plugins -->
	<script src="{% static 'js/jquery.min.js' %}"></script>
	<script src="{% static 'js/bootstrap.min.js' %}"></script>
	<script src="{% static 'js/slick.min.js' %}"></script>
	<script src="{% static 'js/nouislider.min.js' %}"></script>
	<script src="{% static 'js/jquery.zoom.min.js' %}"></script>
	<script src="{% static 'js/main.js' %}"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js' %}"></script>

<script type="text/javascript">
var d = document,cnt=0,
    itemBox = d.querySelectorAll('.item_box'), // блок каждого товара
    cur_price = d.getElementById('cart_price'),
		cartCont = d.getElementById('cart_content'); // блок вывода данных корзины
// Функция кроссбраузерная установка обработчика событий
function addEvent(elem, type, handler){
  if(elem.addEventListener){
    elem.addEventListener(type, handler, false);
  } else {
    elem.attachEvent('on'+type, function(){ handler.call( elem ); });
  }
  return false;
}
// Получаем данные из LocalStorage
function getCartData(){
	return JSON.parse(localStorage.getItem('cart'));
}
// Записываем данные в LocalStorage
function setCartData(o){
	localStorage.setItem('cart', JSON.stringify(o));
	return false;
}
// Добавляем товар в корзину
function addToCart(e){
	this.disabled = true; // блокируем кнопку на время операции с корзиной

	var cartData = getCartData() || {}, // получаем данные корзины или создаём новый объект, если данных еще нет
			parentBox = this.parentNode, // родительский элемент кнопки &quot;Добавить в корзину&quot;

			itemId = this.getAttribute('data-id'), // ID товара
			itemTitle = parentBox.querySelector('.item_title').innerHTML, // название товара
			itemPrice = parentBox.querySelector('.item_price').innerHTML; // стоимость товара
	if(cartData.hasOwnProperty(itemId)){ // если такой товар уже в корзине, то добавляем +1 к его количеству
		cartData[itemId][2] += 1;
	} else { // если товара в корзине еще нет, то добавляем в объект
		cartData[itemId] = [itemTitle, itemPrice, 1];
	}
	// Обновляем данные в LocalStorage
	if(!setCartData(cartData)){
		this.disabled = false; // разблокируем кнопку после обновления LS
		cartCont.innerHTML = 'Товар добавлен в корзину.';
		cnt+=parseInt(itemPrice,10);
		cur_price.innerHTML = cnt;
		setTimeout(function(){
			cartCont.innerHTML = 'Продолжить покупки...';
		}, 1000);
	}

	return false;
}
// Устанавливаем о бработчик события на каждую кнопку &quot;Добавить в корзину&quot;
for(var i = 0; i < itemBox.length; i++){
	addEvent(itemBox[i].querySelector('.add_item'), 'click', addToCart);
}
// Открываем корзину со списком добавленных товаров
function openCart(e){

	var cartData = getCartData(), // вытаскиваем все данные корзины
			totalItems = '';
	console.log(JSON.stringify(cartData));
	// если что-то в корзине уже есть, начинаем формировать данные для вывода
	if(cartData !== null){
		totalItems = '<div class="product product-widget">';
		for(var items in cartData){
				totalItems +='<div class="product-body"><h3 class="product-price">'+
												cartData[items][1]+ '<br><span class="qty">'+cartData[items][2]+
												'</span></h3><h2 class="product-name"><a href="#">'+cartData[items][0]+'</a></h2></div>';
		}
		totalItems +='</div>';
		cartCont.innerHTML = totalItems;
	} else {
		// если в корзине пусто, то сигнализируем об этом
		cartCont.innerHTML = 'В корзине пусто!';
	}
	return false;
}
/* Открыть корзину */
addEvent(d.getElementById('checkout'), 'click', openCart);
/* Очистить корзину */
addEvent(d.getElementById('clear_cart'), 'click', function(e){
	localStorage.removeItem('cart');
	cnt=0;
	cartCont.innerHTML = 'Корзина очишена.';
});
</script>
</body>

</html>
